<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DATA PELAMAR FLK Nasional</title>
  <script src="https://unpkg.com/gridjs/dist/gridjs.umd.js"></script>
  <link href="https://unpkg.com/gridjs/dist/theme/mermaid.min.css" rel="stylesheet" />
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 2rem;
    }
    h1 {
      text-align: center;
      margin-bottom: 2rem;
    }
    .filters {
      display: flex;
      gap: 1rem;
      margin-bottom: 1rem;
      flex-wrap: wrap;
    }
    .filters label {
      display: flex;
      flex-direction: column;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <h1>DATA PELAMAR FLK Nasional</h1>
  <div class="filters">
    <label>
      JENIS KELAMIN
      <select id="filterGender">
        <option value="">Semua</option>
      </select>
    </label>
    <label>
      MINAT POSISI KERJA PERTAMA
      <select id="filterPosisi">
        <option value="">Semua</option>
      </select>
    </label>
  </div>
  <div id="wrapper"></div>

  <script>
    const SHEET_URL = 'https://opensheet.elk.sh/1cRKdIFwWuHauauIZsJ7_nrzSjygh7PCNhLFXuIm5b3g/670178857';

    let originalData = [];

    const columnNames = [
      "TIMESTAMP", "EMAIL AKTIF", "SUMBER INFORMASI LOWONGAN", "NAMA LENGKAP (SESUAI KTP)",
      "TANGGAL LAHIR", "NOMOR WA AKTIF", "NOMOR HP AKTIF", "JENIS KELAMIN",
      "PENGALAMAN KERJA TERAKHIR", "DURASI PENGALAMAN KERJA", "MINAT POSISI KERJA PERTAMA",
      "MINAT POSISI KERJA KEDUA", "MINAT POSISI KERJA KETIGA", "PENDIDIKAN TERAKHIR",
      "NAMA SEKOLAH / NAMA UNIVERITAS", "JURUSAN", "KEPEMILIKAN KENDARAAN",
      "KEPEMILIKAN SIM AKTIF", "ALAMAT DOMISILI", "PROVINSI MINAT PENEMPATAN",
      "KOTA MINAT PENEMPATAN", "KECAMATAN", "KELURAHAN", "UPLOAD CV",
      "NAMA REFERENSI", "TEMPAT INFORMASI", "MINAT INDUSTRI"
    ];

    function populateFilters(data) {
      const genderSet = new Set();
      const posisiSet = new Set();

      data.forEach(row => {
        genderSet.add(row["JENIS KELAMIN"]);
        posisiSet.add(row["MINAT POSISI KERJA PERTAMA"]);
      });

      const genderSelect = document.getElementById("filterGender");
      genderSet.forEach(item => {
        if (item) {
          const option = document.createElement("option");
          option.value = item;
          option.textContent = item;
          genderSelect.appendChild(option);
        }
      });

      const posisiSelect = document.getElementById("filterPosisi");
      posisiSet.forEach(item => {
        if (item) {
          const option = document.createElement("option");
          option.value = item;
          option.textContent = item;
          posisiSelect.appendChild(option);
        }
      });
    }

    function filterData() {
      const gender = document.getElementById("filterGender").value;
      const posisi = document.getElementById("filterPosisi").value;

      return originalData.filter(row => {
        return (!gender || row["JENIS KELAMIN"] === gender) &&
               (!posisi || row["MINAT POSISI KERJA PERTAMA"] === posisi);
      });
    }

    function renderTable(data) {
      const grid = new gridjs.Grid({
        columns: columnNames,
        data: data.map(row => columnNames.map(col => row[col] || "")),
        pagination: {
          limit: 50
        },
        fixedHeader: true,
        sort: true,
        search: true
      });
      document.getElementById("wrapper").innerHTML = "";
      grid.render(document.getElementById("wrapper"));
    }

    async function loadData() {
      const response = await fetch(SHEET_URL);
      const data = await response.json();
      originalData = data;

      populateFilters(data);
      renderTable(data);

      document.getElementById("filterGender").addEventListener("change", () => {
        renderTable(filterData());
      });
      document.getElementById("filterPosisi").addEventListener("change", () => {
        renderTable(filterData());
      });
    }

    loadData();
  </script>
</body>
</html>
